; =============================================================================
; stunnel Client Configuration - PostgreSQL TLS Outbound Tunnel
; =============================================================================
;
; Architecture:
;   App (127.0.0.1:15432) → stunnel (client) → Remote TLS (postgresql.svc.plus:443)
;
; =============================================================================

foreground = yes
debug = 5

[postgres-client]
client = yes
accept = 0.0.0.0:15432
connect = ${REMOTE_HOST}:${REMOTE_PORT}

; verify = 2 is recommended for production (verify server certificate)
; If using Let's Encrypt, the system CA certificates are usually enough.
; Alpine based images might need /etc/ssl/certs/ca-certificates.crt
verify = 2
CAfile = /etc/ssl/certs/ca-certificates.crt
checkHost = ${REMOTE_HOST}

; Performance tuning
socket = l:TCP_NODELAY=1
socket = r:TCP_NODELAY=1
socket = l:SO_KEEPALIVE=1
socket = r:SO_KEEPALIVE=1

TIMEOUTclose = 0
TIMEOUTidle = 43200
